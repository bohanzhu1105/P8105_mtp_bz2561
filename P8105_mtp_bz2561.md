P8105_mtp_bz2561
================
Bohan Zhu
2025-10-18

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
```

# Import and Tidy Data

``` r
exostosis_df = 
  read_excel("data/p8105_mtp_data.xlsx", skip = 8, na = c("NA", ".", "")) |> 
  janitor::clean_names() 
  
exostosis_clean = 
  exostosis_df |> 
  mutate(
    sex= case_match(
      sex, 
      0 ~ "female",
      1 ~ "male"
    ),
    age_group = case_match(
      age_group,
      "2" ~ "18_30",
      "3" ~ "31_40",
      "4" ~ "41_50",
      "5" ~ "51_60",
      c("6", "7", "8") ~ "60+"
    ) |> 
      factor(levels = c("18_30", "31_40", "41_50", "51_60", "60+"),
           ordered = TRUE),
    eop_size_mm = if_else(is.na(eop_size_mm), 0, eop_size_mm),
    eop_size = case_match(
    eop_size,
    "0" ~ "0_5",
    "1" ~ "5_10",
    "2" ~ "10_15",
    "3" ~ "15_20",
    "4" ~ "20_25",
    "5" ~ "25+"
    ) |> 
      factor(levels = c("0_5", "5_10", "10_15", "15_20", "20_25","25+"),
           ordered = TRUE),
    eop_visibility_classification = case_match(
      eop_visibility_classification,
      0 ~ "eop size 0",
      1 ~ "0 < eop size  <=5",
      2 ~ "eop size >= 5"
    ) |> 
      factor(levels = c("eop size 0", "0 < eop size  <=5", "eop size >= 5"),
           ordered = TRUE),
    fhp_category = case_match(
      fhp_category,
      "0" ~ "0_10",
      "1" ~ "10_20",
      "2" ~ "20_30",
      "3" ~ "30_40",
      "4" ~ "40_50",
      "5" ~ "50_60",
      "6" ~ "60_70",
      "7" ~ "70+"
    ) |> 
      factor(levels = c("0_10", "10_20", "20_30", "30_40", "40_50",
                        "50_60","60_70","70+"),
           ordered = TRUE)
  )
```

The dataset was imported from an Excel file and cleaned by skipping
unused header rows, standardizing variable names, and converting missing
values into proper NAs. Each numeric code from the original report was
translated into meaningful labels for clarity. For example, sex was
recoded as male and female, and age groups were organized into ordered
categories such as 18–30, 31–40, 41–50, 51–60, and 60+.

Missing EOP size measurements were replaced with zeros, and both EOP and
FHP size classifications were converted into readable, ordered factor
levels (e.g., 0–5 mm, 5–10 mm, 10–15 mm, etc.). The variable
eop_visibility_classification was also recoded to reflect visibility
categories (EOP size 0 mm, 0 \< EOP ≤ 5 mm, EOP ≥ 5 mm).

``` r
exostosis_clean |> 
  summarise(n())
```

    ## # A tibble: 1 × 1
    ##   `n()`
    ##   <int>
    ## 1  1221

``` r
exostosis_clean |> 
  group_by(sex) |> 
  summarise(participants = n()) |> 
  knitr::kable()
```

| sex    | participants |
|:-------|-------------:|
| female |          614 |
| male   |          607 |

``` r
exostosis_clean |> 
  group_by(age_group) |> 
  summarise(participants = n()) |> 
  knitr::kable()
```

| age_group | participants |
|:----------|-------------:|
| 18_30     |          303 |
| 31_40     |          204 |
| 41_50     |          207 |
| 51_60     |          200 |
| 60+       |          305 |
| NA        |            2 |

After cleaning, the resulting dataset contained 1221 observations and 9
variables. Among the variables, several are key to the analysis.
`EOP size` and `EOP visibility classification` are crucial because they
describe the prominence and visibility of the external enlarged
protuberance — the main anatomical feature studied. `FHP size` and
`FHP category` are also important, as they measure forward head posture,
which may be linked to EOP development. Finally, `sex` and `age group`
provide demographic context to explore biological or behavioral
differences across participants.

``` r
exostosis_clean |> 
  group_by(eop_shape) |> 
  summarise(participants = n()) |> 
  knitr::kable()
```

| eop_shape | participants |
|----------:|-------------:|
|         1 |          385 |
|         2 |           95 |
|         3 |          218 |
|         5 |            1 |
|        NA |          522 |

``` r
exostosis_clean |> 
  filter(is.na(fhp_size_mm))
```

    ## # A tibble: 6 × 9
    ##   sex      age age_group eop_size_mm eop_size eop_visibility_classif…¹ eop_shape
    ##   <chr>  <dbl> <ord>           <dbl> <ord>    <ord>                        <dbl>
    ## 1 male      61 60+               0   0_5      0 < eop size  <=5               NA
    ## 2 male      24 18_30             8.1 5_10     eop size >= 5                    1
    ## 3 male      60 51_60             6.7 5_10     eop size >= 5                    3
    ## 4 female    28 18_30            17.8 15_20    eop size >= 5                    1
    ## 5 male      23 18_30            12.8 10_15    eop size >= 5                    3
    ## 6 female    31 31_40            11.1 10_15    eop size >= 5                    1
    ## # ℹ abbreviated name: ¹​eop_visibility_classification
    ## # ℹ 2 more variables: fhp_size_mm <dbl>, fhp_category <ord>

``` r
exostosis_df |>
  mutate(fhp_category = as.numeric(fhp_category)) |>
  filter(fhp_category > 7) |> 
  select(fhp_category)
```

    ## # A tibble: 1 × 1
    ##   fhp_category
    ##          <dbl>
    ## 1         30.8

The dataset shows several issues where categorical variables do not
fully match their underlying continuous measures. For instance,
`eop_shape` includes categories 1, 2, 3, and 5, but category 4 is
missing, while over 500 observations are recorded as NA, suggesting
incomplete or inconsistent coding. In `fhp_category`, one record has a
value of 30.8, which by definition should fall within the 30–40 range
but was not properly categorized. Additionally, six missing values were
identified in `fhp_size_mm`, meaning that a few participants lack
corresponding FHP measurements.

# Visualization

# Reproducing reported results and discussion
